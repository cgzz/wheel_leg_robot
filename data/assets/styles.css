:root {
    --gap: 12px;
    --card-bg: #fff;
    --card-bd: #e5e7eb
}

html,
body {
    margin: 0;
    padding: 0;
    background: #f6f7fb;
    color: #111;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial
}

.wrap {
    max-width: 1200px;
    margin: 24px auto;
    padding: 0 16px
}

.grid {
    display: grid;
    gap: var(--gap)
}

.grid.cols-3 {
    grid-template-columns: repeat(3, 1fr)
}

.card {
    background: var(--card-bg);
    border: 1px solid var(--card-bd);
    border-radius: 14px;
    padding: 14px
}

h1 {
    font-size: 22px;
    margin: 0 0 10px
}

h2 {
    font-size: 16px;
    margin: 0 0 8px;
    color: #374151
}

.toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center
}

.btn {
    padding: 10px 14px;
    border: 1px solid #d1d5db;
    border-radius: 10px;
    background: #fff;
    cursor: pointer;
    user-select: none
}

.btn:active {
    transform: translateY(1px)
}

.btn.toggle.active {
    background: #e0f2fe;
    border-color: #7dd3fc
}

.sliders {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--gap)
}

.slider-item {
    background: #fff;
    border: 1px solid var(--card-bd);
    border-radius: 12px;
    padding: 10px
}

.slider-head {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 13px;
    color: #374151;
    gap: 8px;
    align-items: center
}

.slider-head .nbox {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 12px
}

.slider-head .nbox input {
    width: 80px;
    padding: 6px 8px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    font-family: ui-monospace, Menlo, monospace
}

input[type=range] {
    width: 100%
}

.flex {
    display: flex;
    gap: var(--gap);
    align-items: stretch
}

.flex>.card {
    flex: 1
}

/* 遥控区域：左上固定布置，宽度固定，读数高度固定，避免抖动 */
.joystick-wrap {
    display: flex;
    justify-content: flex-start;
    align-items: flex-start
}

.joy-panel {
    width: 260px
}

.joystick {
    width: 220px;
    height: 220px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #fafafa, #e5e7eb);
    position: relative;
    border: 1px solid #d1d5db;
    touch-action: none;
    user-select: none;
    display: block;
    margin: 0
}

.stick {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle at 30% 30%, #fff, #d1d5e1);
    border: 1px solid #cbd5e1;
    box-shadow: 0 6px 16px rgba(0, 0, 0, .12)
}

.joy-readout {
    font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
    font-size: 13px;
    color: #334155;
    white-space: pre;
    height: 18px;
    line-height: 18px;
    margin-top: 8px
}

canvas {
    width: 100% !important;
    height: 260px !important
}

#robotCanvas {
    width: 100%;
    height: 360px;
    display: block;
    background: #f8fafc;
    border: 1px dashed #e5e7eb;
    border-radius: 8px
}

.height-ctrl {
    margin-top: 8px;
    font-size: 13px;
    color: #374151;
    display: flex;
    gap: 10px;
    align-items: center
}

.height-ctrl input[type=range] {
    width: 220px
}

.switch {
    position: relative;
    display: inline-block;
    width: 54px;
    height: 30px
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0
}

.slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background: #e5e7eb;
    border-radius: 999px;
    transition: all .2s
}

.slider:before {
    position: absolute;
    content: "";
    height: 24px;
    width: 24px;
    left: 3px;
    top: 3px;
    background: #fff;
    border-radius: 50%;
    transition: all .2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, .15)
}

input:checked+.slider {
    background: #4ade80
}

input:checked+.slider:before {
    transform: translateX(24px)
}

.hz {
    display: flex;
    align-items: center;
    gap: 8px
}

/* 日志固定高度 + 内滚动 */
#log {
    height: 200px;
    overflow: auto;
    margin: 0
}

@media (max-width:1024px) {
    .grid.cols-3 {
        grid-template-columns: 1fr
    }

    .flex {
        flex-direction: column
    }
}
/* ==== Test Mode additions ==== */
.hidden {
    display: none !important;
}

.mode-group {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.mode-group .btn.active {
    background: #e0f2fe;
    border-color: #7dd3fc;
}

.test-ctrl {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
}
/* === 按钮按下效果（触控也能生效） === */
.btn.is-press {
    /* 由 JS 在 pointerdown 时加上，pointerup 移除 */
    background: #e5f0ff;
    border-color: #93c5fd;
    transform: translateY(1px);
    transition: background .08s ease, border-color .08s ease, transform .08s ease;
}

/* === 测试模式：选中样式（互斥） === */
.mode-group .btn.active {
    background: #e0f2fe;
    border-color: #7dd3fc;
}
/* === 测试模式：滑条更长 & 数字框和 PID 保持一致 === */
.test-ctrl input[type=range] {
    width: 420px;
    /* ← 比默认更长 */
    max-width: 100%;
}

.test-ctrl .nbox {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
}

.test-ctrl .nbox input {
    width: 100px;
    /* 比 PID 的 80px 稍宽，便于输入小数 */
    padding: 6px 8px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    font-family: ui-monospace, Menlo, monospace;
}

/* === 摇杆：标题左上，但摇杆本体居中 === */
.joy-panel .joystick {
    margin-left: auto;
    margin-right: auto;
}
/* ==== 摔倒指示灯 ==== */
.bulb {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    border: 1px solid #cbd5e1;
    background: #e5e7eb;
    /* 默认灰 */
    vertical-align: middle;
    box-shadow: inset 0 0 0 2px rgba(255, 255, 255, .7);
}

.hz .bulb {
    margin-right: 6px;
}

.bulb.green {
    background: #22c55e;
    box-shadow:
        inset 0 0 0 2px rgba(255, 255, 255, .6),
        0 0 10px rgba(34, 197, 94, .75);
    border-color: #16a34a;
}

.bulb.red {
    background: #ef4444;
    box-shadow:
        inset 0 0 0 2px rgba(255, 255, 255, .6),
        0 0 10px rgba(239, 68, 68, .75);
    border-color: #dc2626;
}

.bulb.off {
    background: #e5e7eb;
    border-color: #cbd5e1;
    box-shadow: inset 0 0 0 2px rgba(255, 255, 255, .7);
}